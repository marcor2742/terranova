<div style="width: 180px; height: 180px; position: fixed; z-index: -1; top: 50%; left: 50%; transform: translateX(150px) translateY(-320px);">
    <img src="assets/login/limone.png" class="lemon-slice" alt="Fetta di limone">
</div>
<div style="width: 180px; height: 180px; position: fixed; z-index: -1; top: 50%; left: 50%; transform: translateX(-350px) translateY(90px);">
    <img src="assets/login/menta.png" class="mint-leaf" alt="Foglia di menta" style="transform: rotate(-45deg);">
</div>

<div class="box">
    @if (showEmailConfirmation()) {
    <h2>{{ "RegisterPage" | translate }}</h2>
    } @else {
    <h2>{{ "LoginPage" | translate }}</h2>
    }

    <!-- Remove the ngSubmit from the form -->
    <form [formGroup]="loginForm">
        <!-- Username field with user existence check -->
        <div class="form-field">
            <label for="username">Username:</label>
            <input id="username" type="text" formControlName="username" />
            <div *ngIf="
                    loginForm.get('username')?.touched &&
                    loginForm.get('username')?.errors
                "
                 class="error">
                <div *ngIf="loginForm.get('username')?.errors?.['required'] && (showEmailConfirmation() && loginForm.get('email'))">
                    Username is required
                </div>
                <div *ngIf="loginForm.get('username')?.errors?.['minlength']">
                    Username must be at least 4 characters
                </div>
            </div>
        </div>

        <div class="form-field" *ngIf="showEmailConfirmation()">
            <label for="email">Full Email:</label>
            <input id="email" type="email" formControlName="email" />
            <div *ngIf="
                    loginForm.get('email')?.touched &&
                    loginForm.get('email')?.errors
                "
                 class="error">
                <div *ngIf="loginForm.get('email')?.errors">
                    Please enter a valid email
                </div>
            </div>
            <!-- Email existence feedback -->
            <div *ngIf="emailError()" class="error email-exists">
                {{ emailError() }}
            </div>
        </div>

        <!-- Password field -->
        <div class="form-field">
            <label for="password">Password:</label>
            <input id="password" type="password" formControlName="password" />
            <div *ngIf="
                    loginForm.get('password')?.touched &&
                    loginForm.get('password')?.errors
                "
                 class="error">
                <div *ngIf="loginForm.get('password')?.errors?.['required']">
                    Password is required
                </div>
            </div>
        </div>

        <!-- In your button group div -->
        <div class="button-group">
            <my-ui-button text="LOGIN"
                          variant="default"
                          size="lg"
                          type="button"
                          [disabled]="!loginForm.valid"
                          (buttonClick)="login()"
                          class="visible-button"></my-ui-button>

            <my-ui-button text="REGISTER"
                          variant="outline"
                          size="lg"
                          type="button"
                          (buttonClick)="register()"
                          class="visible-button"></my-ui-button>
        </div>
    </form>
</div>